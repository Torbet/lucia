---
import type { SubCollection } from "../content";
type Props = {
    subCollections: SubCollection[];
};
---

<div
    class="flex flex-col gap-y-6 overflow-auto h-full overscroll-contain pt-2 pb-8 text-sm"
>
    {
        Astro.props.subCollections.map((subCollection) => {
            return (
                <div>
                    <p class="ml-8 text-sm font-medium text-zinc-400">
                        {subCollection.title}
                    </p>
                    <ul class="mt-0.5">
                        {subCollection.pages
                            .filter((page) => !page.hidden)
                            .map((page) => {
                                const urlPathname = [
                                    "",
                                    ...page.pathname
                                        .split("/")
                                        .filter((segment, i) => {
                                            return (
                                                i !== 0 || segment !== "main"
                                            );
                                        })
                                ].join("/");
                                const selected =
                                    Astro.url.pathname.split("/").length >=
                                        page.pathname.split("/").length &&
                                    Astro.url.pathname.includes(urlPathname);
                                return (
                                    <li>
                                        <a
                                            href={urlPathname}
                                            class:list={[
                                                "w-full py-1 pl-8 hover:bg-indigo-50 block",
                                                {
                                                    "bg-gray-100": selected
                                                }
                                            ]}
                                            set:html={page.htmlTitle}
                                        />
                                    </li>
                                );
                            })}
                    </ul>
                </div>
            );
        })
    }
</div>
